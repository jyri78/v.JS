/* Copyright (C) 2023 Jüri Kormik, released under the GPLv3 */
class VJS{constructor(e={}){"undefined"==typeof window&&VJS._err(VJS._E1,1),"function"!=typeof String.prototype.replaceAll&&VJS._err(VJS._E2,0),e&&e.constructor===({}).constructor&&VJS._ᐦso(e)}$(e,t=document,r=!1){return VJS._ᐦe(e,t,r)}$$(e,t,r="id",n=!1){let l={id:"#",class:".",name:"=",tag:"@"},s=VJS._ᐦi(),o=s.$gda(e,t);return o?(Object.keys(l).includes(r)&&(o=`${l[r]}${o}`),s.$(o,0,n)):null}$$n(e,t,r=!1){return VJS._ᐦi().$$(e,t,"name",r)}$$c(e,t,r=!1){return VJS._ᐦi().$$(e,t,"class",r)}$$t(e,t,r=!1){return VJS._ᐦi().$$(e,t,"tag",r)}$$q(e,t,r=!1){return VJS._ᐦi().$$(e,t,"query",r)}$i(e){return VJS._ᐦgo(e,"#")}getElemById(e){return VJS._ᐦi().$i(e)}$n(e,t=!1){return VJS._ᐦgo(e,"=",null,!t)}getElemsByName(e,t=!1){return VJS._ᐟ$n(e,t)}$c(e,t=document,r=!1){return VJS._ᐦgo(e,".",t,!r)}getElemsByClass(e,t=document,r=!1){return VJS._ᐦi().$c(e,t,r)}$t(e,t=document,r=!1){return VJS._ᐦgo(e,"@",t,!r)}getElemsByTag(e,t=document,r=!1){return VJS._ᐦi().$t(e,t,r)}$q(e,t=document,r=!1){return(t=VJS._ᐦo(t))||(t=document),VJS._ᐟ$q(t,e,r)}querySel(e,t=document,r=!1){return VJS._ᐦi().$q(e,t,r)}$f(e,t,r=""){let n;if(r){let l=r.split("|");if(l.length<2)return[];n=VJS._ᐦi().$$(l[0],e,l[1],1)}else n=VJS._ᐦi().$(e,0,1);return n?n instanceof HTMLElement?[n]:n?.[Symbol.iterator]?[...n].filter(t):[]:[]}filter(e,t,r=""){return VJS._ᐦi().$f(e,t,r)}$h(e,t="",r=null){let n=VJS._ᐦh(e,t,r);if(!r)return n}height(e,t="",r=null){let n=VJS._ᐦh(e,t,r);if(!r)return n}$w(e,t="",r=null){let n=VJS._ᐦw(e,t,r);if(!r)return n}width(e,t="",r=null){let n=VJS._ᐦw(e,t,r);if(!r)return n}$s(e,t="",r=null,n=null){let l={width:VJS._ᐦw(e,t,r||n),height:VJS._ᐦh(e,t,n||r)};if(!r&&!n)return l}size(e,t="",r=null,n=null){let l=VJS._ᐦi().$s(e,t,r,n);if(l)return l}$sp(e,t="form"){if(!(e=VJS._ᐦo(e))||e instanceof Window)return null;for(;e.nodeName.toLowerCase()!==t;){if(!e.parentNode)return null;e=e.parentNode}return e}selParent(e,t="form"){return VJS._ᐦi().$sp(e,t)}$cs(e,t=""){return VJS._ᐦi().$f(e,e=>e.textContent.includes(t))}containsSel(e,t=""){return VJS._ᐦi().$cs(e,t)}$ha(e,t=""){return(e=VJS._ᐦo(e,null))?t?e.hasAttribute(t):e.hasAttributes():void 0}hasAttrib(e,t=""){return VJS._ᐦi().$ha(e,t)}$ga(e,t,r=null){if(!(e=VJS._ᐦo(e,null))||!VJS._ᐦi().$ha(e,t))return r;let n=e.getAttribute(t);return n?VJS._ᐦvn(n):r}getAttrib(e,t,r=null){return VJS._ᐦi().$ga(e,t,r)}$sa(e,t,r=!0){if(!(e=VJS._ᐦo(e,null)))return;let n=0;"boolean"==typeof r?"translate"===t?r=r?"yes":"no":["contenteditable","draggable","spellcheck"].includes(t)?r=r?"true":"false":["autocomplete","autocorrect"].includes(t)?r=r?"on":"off":r?r=t:n=1:r||(n=1),n?VJS._ᐦi().$ra(e,t):e.setAttribute(t,r)}setAttrib(e,t,r=!0){VJS._ᐦi().$sa(e,t,r)}$ra(e,t){(e=VJS._ᐦo(e,null))&&e.removeAttribute(t)}remAttrib(e,t){VJS._ᐦi().$ra(e,t)}$st(e,t,r=[],n=!1){if(isNaN(e))return 0;let l=1e3*e;return r instanceof Array||(r=[r]),r.length?n?setInterval(t,l,...r):setTimeout(t,l,...r):n?setInterval(t,l):setTimeout(t,l)}$ct(e,t=!1){e&&(t?clearInterval(e):clearTimeout(e))}$fd(e,t="",r=[],n={},l=null){t=["str","string","json"].includes(t=t.toLowerCase())?t.substring(0,1):"fd";let s=VJS._ᐦfd(e,t,r,n);return("nfe"===s.err&&VJS._ᐦde(VJS._E7),"mrf"===s.err&&(l&&l.error&&l.success?s.ids.forEach(e=>{s.data.includes(e)?(VJS._ᐦc(e,[l.success],"remove"),VJS._ᐦc(e,[l.error],"add")):(VJS._ᐦc(e,[l.error],"remove"),VJS._ᐦc(e,[l.success],"add"))}):VJS._err(VJS._E3)),s.err)?null:s.data}$ws(e,t){let r=["open","message","close","error"],n=!1,l,s;try{"//"===e.substring(0,2)&&(e=`wss:${e}`),l=new URL(e.trim())}catch(o){return VJS._err(VJS._E9,0,TypeError,o),null}if("ws:"!==l.protocol&&"wss:"!==l.protocol)return VJS._ᐦde(VJS._E9,0,"SyntaxError"),null;for(let a in Object.keys(t))r.includes(a)&&(n=!0);e=`${l.origin}${l.pathname}${l.search}`;try{s=new WebSocket(e)}catch(u){return VJS._err(u.message),null}for(let c in Object.keys(t))r.includes(c)&&(s[`on${c}`]=t[c]);return s}$cel(e="div",t=""){if("string"!=typeof e)return null;let r=[e];return t&&r.push({is:t}),document.createElement(...r)}createElem(e="div",t=""){return VJS._ᐦi().$cel(e,t)}$cels(e,t=null){if("string"!=typeof e)return null;let r=VJS._ᐦi().$ce(),n;if(r.innerHTML=e.trim(),n=r.children,t&&(t=VJS._ᐦo(t)))for(let l of n)t.append(l);return n}createElems(e){return VJS._ᐦi().$cels(e)}$hda(e,t,r=!1){let n=VJS._ᐦdn(t,r);if(!n){let l=VJS._ᐦda(e,r);if(!l)return;return l.length>0}return VJS._ᐦi().$ha(e,n)}hasDataAttrib(e,t){return VJS._ᐦi().$hda(e,t)}$gda(e,t,r=null,n=!1){return VJS._ᐦi().$ga(e,VJS._ᐦdn(t,n),r)}getDataAttrib(e,t,r=null,n=!1){return VJS._ᐦi().$gda(e,t,r,n)}$sda(e,t,r=!0){t&&("boolean"==typeof r&&(r|=0),VJS._ᐦi().$sa(e,VJS._ᐦdn(t),r))}setDataAttrib(e,t,r){VJS._ᐦi().$sda(e,t,r)}$rda(e,t){t&&VJS._ᐦi().$ra(e,VJS._ᐦdn(t))}remDataAttrib(e,t){VJS._ᐦi().$rda(e,t)}$dav(e,t,r=!1){let n={},l=VJS._ᐦi();return Array.isArray(t)||(t=[t]),t.forEach(t=>{n[r?t[0]:t]=l.$gda(e,t)??""}),n}dataAttribVals(e,t,r=!1){VJS._ᐦi().$dav(e,t,r)}$hcl(e,t=""){return(e=VJS._ᐦo(e,null))?t?e.classList.contains(t):e.classList.length>0:void 0}hasClass(e,t){return VJS._ᐦi().$hcl(e,t)}$gcl(e){return(e=VJS._ᐦo(e,null))?e.classList?[...e.classList]:[]:void 0}getClasses(e){return VJS._ᐦi().$gcl(e)}$acl(e,t){VJS._ᐦc(e,t,"add")}addClass(e,t){VJS._ᐦi().$acl(e,t)}$rcl(e,t,r=""){r?(Array.isArray(t)&&(t=t[0]),VJS._ᐦc(e,[t,r],"replace")):VJS._ᐦc(e,t,"remove")}remClass(e,t){VJS._ᐦi().$rcl(e,t)}replClass(e,t,r){VJS._ᐦi().$rcl(e,t,r)}$tcl(e,t,r){void 0!==r&&(t=[t,r]),VJS._ᐦc(e,t,"toggle")}toggleClass(e,t,r){VJS._ᐦi().$tcl(e,t,r)}$pos(e){if(!(e=VJS._ᐦo(e,null)))return;let{top:t,left:r}=e.getBoundingClientRect();return{top:t,left:r}}$val(e,t="",r=!1){return(e=VJS._ᐦo(e,null))?t?void(void 0===e.value?e.textContent=t:e.value=t):e.options&&e.multiple?e.options.filter(e=>e.selected).map(e=>VJS._ᐦvn(e.value)):VJS._ᐦvn(e.value||(r?e.textContent:e.innerText)):""}$ael(e,t=window,r="DOMContentLoaded"){if("function"==typeof e){if(t instanceof Array)return VJS._ᐦi().$aels(e,t,r);(t=VJS._ᐦo(t,window))&&t.addEventListener(r,e)}}addEvtListener(e,t=window,r=VJS._L){VJS._ᐦi().$ael(e,t,r)}$rel(e,t=window,r="DOMContentLoaded"){if("function"==typeof e){if(t instanceof Array)return VJS._ᐦi().$rels(e,t,r);(t=VJS._ᐦo(t))&&t.removeEventListener(r,e)}}remEvtListener(e,t=window,r=VJS._L){VJS._ᐦi().$rel(e,t,r)}$aels(e,t=[],r="click"){t instanceof Array?t.forEach(t=>VJS._ᐦi().$ael(e,t,r)):VJS._ᐦi().$ael(e,t,r)}addEvtListeners(e,t=[],r="click"){VJS._ᐦi().$aels(e,t,r)}$rels(e,t=[],r="click"){t instanceof Array?t.forEach(t=>VJS._ᐦi().$rel(e,t,r)):VJS._ᐦi().$rel(e,t,r)}remEvtListeners(e,t=[],r="click"){VJS._ᐦi().$rels(e,t,r)}$get(e){return VJS._ᐦr(e)}$put(e,t={}){return VJS._ᐦr(e,"PUT",t)}$del(e,t={}){return VJS._ᐦr(e,"DELETE",t)}$post(e,t={}){return VJS._ᐦr(e,"POST",t)}$patch(e,t={}){return VJS._ᐦr(e,"PATCH",t)}$lsse(e,t,r="",n=!1){if(!e||"function"!=typeof t)return null;let l=new EventSource(e,{withCredentials:n});if(!l)return null;let s=e=>{t(e.data,e.lastEventId,e.origin)};return r?l.addEventListener(r,s):l.onmessage=s,l.onerror=e=>console.error(`'EventSource' ${e.type??"error"} @${VJS._ᐦms(e.timeStamp??0)}`),l}$csse(e){e instanceof EventSource&&e.close()}$html(e,t="",r=""){if(e=VJS._ᐦo(e,null)){if(!t)return e.innerHTML;if(e instanceof Element)try{r?(["beforebegin","afterbegin","beforeend","afterend"].includes(r)||(r="beforeend"),e.insertAdjacentHTML(r,t)):e.innerHTML=t}catch(n){VJS._ᐦde(n.message,0,n.name)}else VJS._ᐦde(VJS._E6,1)}else t&&VJS._ᐦde()}offset(e){if(!(e=VJS._ᐦo(e,null)))return;let t=VJS._ᐦi().$pos(e),r=document.documentElement,n=window;return{top:t.top+n.scrollY-r.clientTop,left:t.left+n.scrollX-r.clientLeft}}position(e){if(!(e=VJS._ᐦo(e,null)))return;let t=VJS._ᐦi().$pos(e),r=getComputedStyle(e);return{top:t.top-parseInt(r.marginTop),left:t.left-parseInt(r.marginLeft)}}serialize(e,t={}){if(!(e=VJS._ᐦgf(e)))return"";let r=new URLSearchParams(e);if("object"==typeof t&&Object.keys(t).length)for(let[n,l]in t)r.append(n,l);return r.toString()}isLive(e){if(e instanceof HTMLCollection)return!0;let t=e.length;if(!t)return;let r=e.item(0),n=r.parentNode,l=r.cloneNode();l.style="display:none!important",n.appendChild(l);let s=e.length!==t;return n.removeChild(l),s}isHidden(e){return!((e=VJS._ᐦo(e,null)).offsetWidth||e.offsetHeight||e.getClientRects().height)}isVisible(e){return!VJS._ᐦi().isHidden(e)}toArray(e){return(e=VJS._ᐦo(e))instanceof NodeList||e instanceof HTMLCollection?[...e]:[e]}static get _E1(){return"VJS class works only in Browser!"}static get _E2(){return"Your Browser does not support ECMAScript11 (2020)!"}static get _E3(){return"Fill up required fields!"}static get _E4(){return"No data given."}static get _E5(){return"No valid Element found."}static get _E6(){return"No valid Element given."}static get _E7(){return"Form not found."}static get _E8(){return"Given data type not supported."}static get _E9(){return"No valid URL given."}static get _RSC(){return{301:"Moved Permanently",307:"Temporary Redirect",308:"Permanent Redirect",400:"Bad Request",401:"Unauthorized",403:"Forbidden",404:"Not Found",406:"Not Acceptable",408:"Request Timeout",409:"Conflict",410:"Gone",500:"Internal Server Error",501:"Not Implemented",502:"Bad Gateway",503:"Service Unavailable",504:"Gateway Timeout",505:"HTTP Version Not Supported"}}static _ᐩi;static _ㅣp;static _ㅣr;static _ㅣe;static _ㅣo;static _ᐟ$i(e){return document.getElementById(e)}static _ᐟ$n(e){return document.getElementsByName(e)}static _ᐟ$c(e,t){return e?e.getElementsByClassName(t):null}static _ᐟ$t(e,t){return e?e.getElementsByTagName(t):null}static _ᐟ$q(e,t,r){try{return e[`querySelector${r?"All":""}`](t)}catch(n){return null}}static _err(e,t=0,r=Error,n=null){if(VJS._ㅣr||t){let l=[e];throw n&&l.push({cause:n}),new r(...l)}VJS._ㅣe?VJS._ㅣe(e):console.error(`Error: ${e}`)}static _ᐦde(e=VJS._E5,t=0,r=""){let n=t?"NotSupportedError":r||"NotFoundError";if(VJS._ㅣr)throw new DOMException(e,n);VJS._ㅣe?VJS._ㅣe(e):console.error(`${n}: ${e}`)}static _ᐦgo(e,t,r=null,n=0){return"string"!=typeof e?null:(["#",".","=","@"].includes(e[0])||(e=`${t}${e}`),VJS._ᐦe(e,r,n))}static _ᐦre(e){"loading"!==document.readyState?e():i.$ael(_f)}static _ᐦso(e,t=0){let r={prefix:"",raiseError:!1,errorCallable:null,onEvtActions:null,formSubmits:null},n=e=>"string"!=typeof e?e:e.trim(),l=Object.keys(e),s=VJS._ᐦi();Object.keys(r).forEach(s=>{l.includes(s)?VJS[`_ㅣ${s[0]}`]=n(e[s]):t||(VJS[`_ㅣ${l[0]}`]=r[s])}),VJS._ㅣp&&(VJS._ㅣp=VJS._ㅣp.replace(/[^\w\d]/gi,"")),VJS._ㅣe&&"function"!=typeof VJS._ㅣe&&(VJS._ㅣe=null),VJS._ㅣo&&(VJS._ㅣo.constructor!==({}).constructor?VJS._ㅣo=null:VJS._ᐦre(()=>{Object.keys(VJS._ㅣo).forEach(e=>{let t=Object.keys(VJS._ㅣo[e]);s.$q(`[${VJS._ᐦdn(e)}]`,document,!0).forEach(r=>{let n=s.$gda(r,e);void 0!==r[`on${e}`]&&"_"!==n[0]&&(t.includes(n)?s.$ael(VJS._ㅣo[e][n],r,e):(r.style.opacity=.25,r.disabled=!0))})})})),VJS._ᐦre(()=>{[...s.$t("form")].map(e=>{let t=t=>s.$q(`[${VJS._ᐦdn(t)}]`,e),r=t("submit");r||(r=t("click")),r&&s.$ael(e=>(e.preventDefault(),r.click(),!1),e,"submit")})})}static _ᐦms(e){let t=e/1e3,r=Math.floor(t/60),n=e=>e<10?`0${e}`:e;return`${n(r)}:${n(t=Math.round((t-60*r)*10)/10)}`}static _ᐦvn(e){if("string"!=typeof e)return e;if(""===(e=e.trim()))return"";if(!isNaN(e)){let t=+e,r=0|t;return t===r?r:t}let n=e.toLowerCase();return"true"===n||"on"===n||"false"!==n&&"off"!==n&&e}static _ᐦi(e=null){return VJS._ᐩi?e&&e.constructor===({}).constructor&&Object.keys(e).length&&VJS._ᐦso(e,1):VJS._ᐩi=new VJS(e),VJS._ᐩi}static _ᐦo(e,t){return e?("string"==typeof e&&"#"!==e[0]&&(e=`#${e}`),this._ᐦe(e,t)??null):null}static _ᐦc(e,t,r){(e=this._ᐦo(e,null))&&(t instanceof Array||(t=[t]),e.classList[r](...t))}static _ᐦdn(e,t=0){return e?VJS._ㅣp?`data-${t?e:`${VJS._ㅣp}-${e}`}`:`data-${e}`:""}static _ᐦda(e,t){if(!(e=VJS._ᐦo(e,null)))return;let r=Object.keys(e.dataset),n=[];return t||!VJS._ㅣp?r:(r.forEach(e=>{e.includes(VJS._ㅣp)&&n.push(e)}),n)}static _ᐦgf(e){if(!e)return null;if(!(e instanceof FormData)){if(e.constructor===({}).constructor){let t=new FormData;for(let r in e)t.append(r,e[r]);e=t}else{let n=VJS._ᐦo(e,null);if(!(n instanceof HTMLFormElement))return null;e=new FormData(n)}}return e}static _ᐦhw(e,t,r,n){if(!(t=VJS._ᐦo(t,null)))return n?void 0:0;let l=e.toLowerCase(),s="Height"===e?["Top","Bottom"]:["Left","Right"];if(n){"function"==typeof n&&(n=n()),"string"==typeof n?t.style[l]=n:t.style[l]=`${n}px`;return}{let o;if("inner"===r)o=t[`client${e}`];else if("outer"===r)o=t[`offset${e}`];else if("with-margin"===r){let a=getComputedStyle(t);o=t.getBoundingClientRect()[l]+parseInt(a[`margin${s[0]}`])+parseInt(a[`margin${s[1]}`])}else o=parseInt(t.style[l]);return o}}static _ᐦh(e,t,r){return VJS._ᐦhw("Height",e,t,r)}static _ᐦw(e,t,r){return VJS._ᐦhw("Width",e,t,r)}static _ᐦe(e,t,r=0){let n=document;if("string"==typeof e){e=e.trim();let l=e.toLowerCase();if(t||(t=n),l.match(/^\#?document$/))return n;if(l.match(/^\#?window$/))return window;if(l.match(/^\#[a-z][\w\-]+$/))return VJS._ᐟ$i(e.substring(1));else if(l.match(/^\.[a-z][\w\-]+$/)){let s=VJS._ᐟ$c(VJS._ᐦo(t),e.substring(1));return r?s:s.item(0)}else if(l.match(/^\=["']?[a-z][\w\-]+["']?$/)){let o=VJS._ᐟ$n(e.substring(1));return r?o:o.item(0)}else{if(!(l.match(/^\@[a-z][\w\-]*$/)||l.match(/^(?:h[1-6]|[abipqsu]|[a-z]{2,})$/)))return VJS._ᐟ$q(t,e,r);let a=VJS._ᐟ$t(VJS._ᐦo(t),"@"===e[0]?e.substring(1):e);return r?a:a.item(0)}}return e instanceof Window?t||r?e:n:e instanceof Document||e instanceof HTMLElement?e:null===t?t:n}static _ᐦfd(e,t,r=[],n={}){if(!(e=VJS._ᐦgf(e)))return{err:"nfe"};r instanceof Array||(r=[r]);let l=[...r],s=[];for(let[o,a]of e){let u=l.indexOf(o);s.push(o),a?u>-1&&l.splice(u,1):VJS._ᐦi().$ha(o,"required")&&l.push(o)}if(l.length)return{err:"mrf",data:l,ids:s};if("object"==typeof n)for(let c in n)e.append(c,n[c].trim());let S;return{err:"",data:S="s"===t?new URLSearchParams(e).toString():"j"===t?Object.entries(Object.fromEntries(e)).reduce((e,[t,r])=>({...e,[t.replace(/\-([\w])/g,e=>e[1].toUpperCase())]:VJS._ᐦvn(r)}),{}):e}}static _ᐦbd(e,t){if("string"==typeof e){if("#"===e[0]){let r=VJS._ᐦfd(e,"j");"nfe"===r.err&&VJS._ᐦde(VJS._E7),"mrf"===r.err&&VJS._err(VJS._E3),e=r.data}else e=Object.fromEntries(new URLSearchParams(e))}else if(e instanceof FormData||e.constructor!==({}).constructor){e[Symbol.iterator]||VJS._err(VJS._E8,0,TypeError);let n={};for(let[l,s]of e)n[l]=s;e=n}return{...Object.fromEntries(t.searchParams),...e}}static async _ᐦr(e,t="GET",r={}){t=t.toUpperCase();let n="POST"===t||"GET"===t,l,s,o,a={method:t,cache:"no-cache"},u=!1,c=null;try{o=new URL(e),e=`${o.origin}${o.pathname}`,r=VJS._ᐦbd(r,o)}catch(S){return VJS._err(VJS._E9,0,TypeError,S),{success:u,data:c,message:S.toString()}}let V=n?new URLSearchParams(r).toString():JSON.stringify(r);if(["PUT","PATCH","POST","DELETE"].includes(t))try{Object.keys(r).length?(a.mode="cors",a.credentials="same-origin",a.headers={"Content-Type":n?"application/x-www-form-urlencoded":"application/json"},a.body=V):"DELETE"!==t&&VJS._err(VJS._E4,1,TypeError)}catch(J){return VJS._err(J.message,0,TypeError,J),{success:u,data:c,message:J.toString()}}else V&&(e+=`?${V}`);try{l=await fetch(e,a)}catch(f){s=f.toString()}if(!l)return{success:u,data:c,message:s};let d,g=l.headers.get("Content-Type");if(u=l.ok){let p="";204===l.status?p="204 No Content":g&&g.includes("/json")?((c=await l.json()).constructor===({}).constructor||Array.isArray(c))&&Object.keys(c).map(e=>c[e]=VJS._ᐦvn(c[e])):"Blob"!==(c=await l.blob()).constructor.name&&(c=await l.text()),d={success:u,data:c,message:p}}else d={success:u,data:c,message:`Response: ${l.status} ${VJS._RSC[l.status]??""}`};return d}static getInstance(e={}){return VJS._ᐦi(e)}static register(e={}){try{let t=VJS.getInstance(e);Object.getOwnPropertyNames(VJS.prototype).filter(e=>"constructor"!==e&&!~e.indexOf("_")).forEach(e=>window[e]=t[e])}catch(r){VJS._err(r.message)}}}