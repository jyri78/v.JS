/* v.JS | Copyright (C) 2023-2025 Jüri Kormik, released under the GPLv3 */
class VJS{constructor(e={}){"undefined"==typeof window&&VJS._err(VJS._E1,1),"function"!=typeof String.prototype.replaceAll&&VJS._err(VJS._E2,0),e&&e.constructor===({}).constructor&&VJS._ᐦso(e)}$(e,t=document,r=!1){return VJS._ᐦe(e,t,r)}$$(e,t,r="id",n=!1){let i={id:"#",class:".",name:"=",tag:"@"},o=VJS._ᐦi(),l=o.$gda(e,t);return l?(Object.keys(i).includes(r)&&(l=`${i[r]}${l}`),o.$(l,0,n)):null}$$n(e,t,r=!1){return VJS._ᐦi().$$(e,t,"name",r)}$$c(e,t,r=!1){return VJS._ᐦi().$$(e,t,"class",r)}$$t(e,t,r=!1){return VJS._ᐦi().$$(e,t,"tag",r)}$$q(e,t,r=!1){return VJS._ᐦi().$$(e,t,"query",r)}$i(e){return VJS._ᐦgo(e,"#")}$n(e,t=!1){return VJS._ᐦgo(e,"=",null,!t)}$c(e,t=document,r=!1){return VJS._ᐦgo(e,".",t,!r)}$t(e,t=document,r=!1){return VJS._ᐦgo(e,"@",t,!r)}$q(e,t=document,r=!1){return t=VJS._ᐦo(t),VJS._ᐟ$q(t,e,r)}$f(e,t,r=""){let n;if(r){let i=r.split("|");if(i.length<2)return[];n=VJS._ᐦi().$$(i[0],e,i[1],1)}else n=VJS._ᐦi().$(e,0,1);return n?n instanceof HTMLElement?[n]:n?.[Symbol.iterator]?[...n].filter(t):[]:[]}$h(e,t="",r=null){let n=VJS._ᐦh(e,t,r);if(!r)return n}$w(e,t="",r=null){let n=VJS._ᐦw(e,t,r);if(!r)return n}$sp(e,t="form"){if(!(e=VJS._ᐦo(e))||e instanceof Window)return null;for(;e.nodeName.toLowerCase()!==t;){if(!e.parentNode)return null;e=e.parentNode}return e}$cs(e,t=""){return VJS._ᐦi().$f(e,e=>e.textContent.includes(t))}$ha(e,t=""){return(e=VJS._ᐦo(e,null))?t?e.hasAttribute(t):e.hasAttributes():void 0}$ga(e,t,r=null){if(!(e=VJS._ᐦo(e,null))||!VJS._ᐦi().$ha(e,t))return r;let n=e.getAttribute(t);return n?VJS._ᐦvn(n):r}$sa(e,t,r=!0){if(!(e=VJS._ᐦo(e,null)))return;let n=0;"boolean"==typeof r?"translate"===t?r=r?"yes":"no":["contenteditable","draggable","spellcheck"].includes(t)?r=r?"true":"false":["autocomplete","autocorrect"].includes(t)?r=r?"on":"off":r?r=t:n=1:r||(n=1),n?VJS._ᐦi().$ra(e,t):e.setAttribute(t,r)}$ra(e,t){(e=VJS._ᐦo(e,null))&&e.removeAttribute(t)}$st(e,t,r=[],n=!1){if(isNaN(e))return 0;let i=1e3*e;return r instanceof Array||(r=[r]),r.length?n?setInterval(t,i,...r):setTimeout(t,i,...r):n?setInterval(t,i):setTimeout(t,i)}$ct(e,t=!1){e&&(t?clearInterval(e):clearTimeout(e))}$fd(e,t="",r=[],n={},i=null){t=["str","string","json"].includes(t=t.toLowerCase())?t.substring(0,1):"fd";let o=VJS._ᐦfd(e,t,r,n);return("nfe"===o.err&&VJS._ᐦde(VJS._E7),"mrf"===o.err&&(i&&i.error&&i.success?o.ids.forEach(e=>{let t=VJS._ᐟ$q(0,`[name="${e}"]`,0)||e;o.data.includes(e)?(VJS._ᐦc(t,[i.success],"remove"),VJS._ᐦc(t,[i.error],"add")):(VJS._ᐦc(t,[i.error],"remove"),VJS._ᐦc(t,[i.success],"add"))}):VJS._err(VJS._E3)),o.err)?null:o.data}$ws(e,t){let r=["open","message","close","error"],n=!1,i,o;try{"//"===e.substring(0,2)&&(e=`wss:${e}`),i=new URL(e.trim())}catch(l){return VJS._err(VJS._E9,0,TypeError,l),null}if("ws:"!==i.protocol&&"wss:"!==i.protocol)return VJS._ᐦde(VJS._E9,0,"SyntaxError"),null;for(let s in Object.keys(t))r.includes(s)&&(n=!0);e=`${i.origin}${i.pathname}${i.search}`;try{o=new WebSocket(e)}catch(a){return VJS._err(a.message),null}for(let u in Object.keys(t))r.includes(u)&&(o[`on${u}`]=t[u]);return o}$cel(e="div",t=""){if("string"!=typeof e)return null;let r=[e];return t&&r.push({is:t}),document.createElement(...r)}$cels(e,t=null){if("string"!=typeof e)return null;let r=VJS._ᐦi().$ce(),n;if(r.innerHTML=e.trim(),n=r.children,t&&(t=VJS._ᐦo(t)))for(let i of n)t.append(i);return n}$hda(e,t,r=!1){let n=VJS._ᐦdn(t,r);if(!n){let i=VJS._ᐦda(e,r);if(!i)return;return i.length>0}return VJS._ᐦi().$ha(e,n)}$gda(e,t,r=null,n=!1){return VJS._ᐦi().$ga(e,VJS._ᐦdn(t,n),r)}$sda(e,t,r=!0){t&&("boolean"==typeof r&&(r|=0),VJS._ᐦi().$sa(e,VJS._ᐦdn(t),r))}$rda(e,t){t&&VJS._ᐦi().$ra(e,VJS._ᐦdn(t))}$dav(e,t,r=!1){let n={},i=VJS._ᐦi();return Array.isArray(t)||(t=[t]),t.forEach(t=>{n[r?t[0]:t]=i.$gda(e,t)??""}),n}$hcl(e,t=""){return(e=VJS._ᐦo(e,null))?t?e.classList.contains(t):e.classList.length>0:void 0}$gcl(e){return(e=VJS._ᐦo(e,null))?e.classList?[...e.classList]:[]:void 0}$acl(e,t){VJS._ᐦc(e,t,"add")}$rcl(e,t,r=""){r?(Array.isArray(t)&&(t=t[0]),VJS._ᐦc(e,[t,r],"replace")):VJS._ᐦc(e,t,"remove")}$tcl(e,t,r){void 0!==r&&(t=[t,r]),VJS._ᐦc(e,t,"toggle")}$pos(e){if(!(e=VJS._ᐦo(e,null)))return;let{top:t,left:r}=e.getBoundingClientRect();return{top:t,left:r}}$val(e,t=null,r=!1){return(e=VJS._ᐦo(e,null))?null===t?e.options&&e.multiple?e.options.filter(e=>e.selected).map(e=>VJS._ᐦvn(e.value)):VJS._ᐦvn(e.value||(r?e.textContent:e.innerText)):void(void 0===e.value?e.textContent=t:e.value=t):""}$ael(e,t=window,r="DOMContentLoaded"){if("function"==typeof e){if(t instanceof Array)return VJS._ᐦi().$aels(e,t,r);(t=VJS._ᐦo(t,window))&&t.addEventListener(r,e)}}$rel(e,t=window,r="DOMContentLoaded"){if("function"==typeof e){if(t instanceof Array)return VJS._ᐦi().$rels(e,t,r);(t=VJS._ᐦo(t))&&t.removeEventListener(r,e)}}$aels(e,t=[],r="click"){t instanceof Array?t.forEach(t=>VJS._ᐦi().$ael(e,t,r)):VJS._ᐦi().$ael(e,t,r)}$rels(e,t=[],r="click"){t instanceof Array?t.forEach(t=>VJS._ᐦi().$rel(e,t,r)):VJS._ᐦi().$rel(e,t,r)}$get(e){return VJS._ᐦr(e)}$put(e,t={}){return VJS._ᐦr(e,"PUT",t)}$del(e,t={}){return VJS._ᐦr(e,"DELETE",t)}$post(e,t={}){return VJS._ᐦr(e,"POST",t)}$patch(e,t={}){return VJS._ᐦr(e,"PATCH",t)}$lsse(e,t,r="",n=!1){if(!e||"function"!=typeof t)return null;let i=new EventSource(e,{withCredentials:n});if(!i)return null;let o=e=>{t(e.data,e.lastEventId,e.origin)};return r?i.addEventListener(r,o):i.onmessage=o,i.onerror=e=>console.error(`'EventSource' ${e.type??"error"} @${VJS._ᐦms(e.timeStamp??0)}`),i}$csse(e){e instanceof EventSource&&e.close()}$html(e,t=null,r=""){if(e=VJS._ᐦo(e,null)){if(null===t)return e.innerHTML;if(e instanceof Element)try{r?(["beforebegin","afterbegin","beforeend","afterend"].includes(r)||(r="beforeend"),e.insertAdjacentHTML(r,t)):e.innerHTML=t}catch(n){VJS._ᐦde(n.message,0,n.name)}else VJS._ᐦde(VJS._E6,1)}else t&&VJS._ᐦde()}size(e,t="",r=null,n=null){let i={width:VJS._ᐦw(e,t,r||n),height:VJS._ᐦh(e,t,n||r)};if(!r&&!n)return i}offset(e){if(!(e=VJS._ᐦo(e,null)))return;let t=VJS._ᐦi().$pos(e),r=document.documentElement,n=window;return{top:t.top+n.scrollY-r.clientTop,left:t.left+n.scrollX-r.clientLeft}}position(e){if(!(e=VJS._ᐦo(e,null)))return;let t=VJS._ᐦi().$pos(e),r=getComputedStyle(e);return{top:t.top-parseInt(r.marginTop),left:t.left-parseInt(r.marginLeft)}}serialize(e,t={}){if(!(e=VJS._ᐦgf(e)))return"";let r=new URLSearchParams(e);if("object"==typeof t&&Object.keys(t).length)for(let[n,i]in t)r.append(n,i);return r.toString()}isLive(e){if(e instanceof HTMLCollection)return!0;let t=e.length;if(!t)return;let r=e.item(0),n=r.parentNode,i=r.cloneNode();i.style="display:none!important",n.appendChild(i);let o=e.length!==t;return n.removeChild(i),o}isHidden(e){return!((e=VJS._ᐦo(e,null)).offsetWidth||e.offsetHeight||e.getClientRects().height)}isVisible(e){return!VJS._ᐦi().isHidden(e)}toArray(e){return(e=VJS._ᐦo(e))instanceof NodeList||e instanceof HTMLCollection?[...e]:[e]}static get _E1(){return"VJS class works only in Browser!"}static get _E2(){return"Your Browser does not support ECMAScript11 (2020)!"}static get _E3(){return"Fill up required fields!"}static get _E4(){return"No data given."}static get _E5(){return"No valid Element found."}static get _E6(){return"No valid Element given."}static get _E7(){return"Form not found."}static get _E8(){return"Given data type not supported."}static get _E9(){return"No valid URL given."}static get _RSC(){return{301:"Moved Permanently",307:"Temporary Redirect",308:"Permanent Redirect",400:"Bad Request",401:"Unauthorized",403:"Forbidden",404:"Not Found",406:"Not Acceptable",408:"Request Timeout",409:"Conflict",410:"Gone",500:"Internal Server Error",501:"Not Implemented",502:"Bad Gateway",503:"Service Unavailable",504:"Gateway Timeout",505:"HTTP Version Not Supported"}}static _ᐩi;static _ㅣp;static _ㅣr;static _ㅣe;static _ㅣo;static _ᐟ$$(e,t,r){e||(e=document);try{return e[t](r)}catch(n){return null}}static _ᐟ$i(e){return VJS._ᐟ$$(0,"getElementById",e)}static _ᐟ$n(e){return VJS._ᐟ$$(0,"getElementsByName",e)}static _ᐟ$c(e,t){return VJS._ᐟ$$(e,"getElementsByClassName",t)}static _ᐟ$t(e,t){return VJS._ᐟ$$(e,"getElementsByTagName",t)}static _ᐟ$q(e,t,r){return VJS._ᐟ$$(e,`querySelector${r?"All":""}`,t)}static _err(e,t=0,r=Error,n=null){if(VJS._ㅣr||t){let i=[e];throw n&&i.push({cause:n}),new r(...i)}VJS._ㅣe?VJS._ㅣe(e):console.error(`Error: ${e}`)}static _ᐦde(e=VJS._E5,t=0,r=""){let n=t?"NotSupportedError":r||"NotFoundError";if(VJS._ㅣr)throw new DOMException(e,n);VJS._ㅣe?VJS._ㅣe(e):console.error(`${n}: ${e}`)}static _ᐦgo(e,t,r=null,n=0){return"string"!=typeof e?null:(["#",".","=","@"].includes(e[0])||(e=`${t}${e}`),VJS._ᐦe(e,r,n))}static _ᐦre(e){"loading"!==document.readyState?e():VJS._ᐦi().$ael(e)}static _ᐦso(e,t=0){let r={prefix:"",raiseError:!1,errorCallable:null,onEvtActions:null,formSubmits:null},n=e=>"string"!=typeof e?e:e.trim(),i=Object.keys(e),o=VJS._ᐦi();Object.keys(r).forEach(o=>{i.includes(o)?VJS[`_ㅣ${o[0]}`]=n(e[o]):t||(VJS[`_ㅣ${i[0]}`]=r[o])}),VJS._ㅣp&&(VJS._ㅣp=VJS._ㅣp.replace(/[^\w\d]/gi,"")),VJS._ㅣe&&"function"!=typeof VJS._ㅣe&&(VJS._ㅣe=null),VJS._ㅣo&&(VJS._ㅣo.constructor!==({}).constructor?VJS._ㅣo=null:VJS._ᐦre(()=>{Object.keys(VJS._ㅣo).forEach(e=>{let t=Object.keys(VJS._ㅣo[e]);o.$q(`[${VJS._ᐦdn(e)}]`,0,!0).forEach(r=>{let n=o.$gda(r,e);void 0!==r[`on${e}`]&&"_"!==n[0]&&(t.includes(n)?o.$ael(VJS._ㅣo[e][n],r,e):(r.style.opacity=.25,r.disabled=!0))})})})),VJS._ᐦre(()=>{[...o.$t("form")].map(e=>{let t=t=>o.$q(`[${VJS._ᐦdn(t)}]`,e),r=t("submit");r||(r=t("click")),r&&o.$ael(e=>(e.preventDefault(),r.click(),!1),e,"submit")})})}static _ᐦms(e){let t=e/1e3,r=Math.floor(t/60),n=e=>e<10?`0${e}`:e;return`${n(r)}:${n(t=Math.round((t-60*r)*10)/10)}`}static _ᐦvn(e){if("string"!=typeof e)return e;if(""===(e=e.trim()))return"";if(!isNaN(e)){let t=+e,r=0|t;return t===r?r:t}let n=e.toLowerCase();return!!["true","yes","on"].includes(n)||!["false","no","off"].includes(n)&&e}static _ᐦi(e=null){return VJS._ᐩi?e&&e.constructor===({}).constructor&&Object.keys(e).length&&VJS._ᐦso(e,1):VJS._ᐩi=new VJS(e),VJS._ᐩi}static _ᐦo(e,t){return e?("string"==typeof e&&"#"!==e[0]&&(e=`#${e}`),this._ᐦe(e,t)??null):null}static _ᐦc(e,t,r){(e=this._ᐦo(e,null))&&(t instanceof Array||(t=[t]),e.classList[r](...t))}static _ᐦdn(e,t=0){return e?VJS._ㅣp?`data-${t?e:`${VJS._ㅣp}-${e}`}`:`data-${e}`:""}static _ᐦda(e,t){if(!(e=VJS._ᐦo(e,null)))return;let r=Object.keys(e.dataset),n=[];return t||!VJS._ㅣp?r:(r.forEach(e=>{e.includes(VJS._ㅣp)&&n.push(e)}),n)}static _ᐦgf(e){if(!e)return null;if(!(e instanceof FormData)){if(e.constructor===({}).constructor){let t=new FormData;for(let r in e)t.append(r,e[r]);e=t}else{let n=VJS._ᐦo(e,null);if(!(n instanceof HTMLFormElement))return null;e=new FormData(n)}}return e}static _ᐦhw(e,t,r,n){if(!(t=VJS._ᐦo(t,null)))return n?void 0:0;let i=e.toLowerCase(),o="Height"===e?["Top","Bottom"]:["Left","Right"];if(n){"function"==typeof n&&(n=n()),"string"==typeof n?t.style[i]=n:t.style[i]=`${n}px`;return}{let l;if("inner"===r)l=t[`client${e}`];else if("outer"===r)l=t[`offset${e}`];else if("with-margin"===r){let s=getComputedStyle(t);l=t.getBoundingClientRect()[i]+parseInt(s[`margin${o[0]}`])+parseInt(s[`margin${o[1]}`])}else l=parseInt(t.style[i]);return l}}static _ᐦh(e,t,r){return VJS._ᐦhw("Height",e,t,r)}static _ᐦw(e,t,r){return VJS._ᐦhw("Width",e,t,r)}static _ᐦe(e,t,r=0){let n=document;if("string"==typeof e){e=e.trim();let i=e.toLowerCase();if(t||(t=n),i.match(/^\#?document$/))return n;if(i.match(/^\#?window$/))return window;if(i.match(/^\#[a-z][\w\-]+$/))return VJS._ᐟ$i(e.substring(1));else if(i.match(/^\.[a-z][\w\-]+$/)){let o=VJS._ᐟ$c(VJS._ᐦo(t),e.substring(1));return r?o:o.item(0)}else if(i.match(/^\=["']?[a-z][\w\-]+["']?$/)){let l=VJS._ᐟ$n(e.substring(1));return r?l:l.item(0)}else{if(!(i.match(/^\@[a-z][\w\-]*$/)||i.match(/^(?:h[1-6]|[abipqsu]|[a-z]{2,})$/)))return VJS._ᐟ$q(t,e,r);let s=VJS._ᐟ$t(VJS._ᐦo(t),"@"===e[0]?e.substring(1):e);return r?s:s.item(0)}}return e instanceof Window?t||r?e:n:e instanceof Document||e instanceof Element?e:null===t?t:n}static _ᐦfd(e,t,r=[],n={}){if(!(e=VJS._ᐦgf(e)))return{err:"nfe"};r instanceof Array||(r=[r]);let i=[...r],o=[];for(let[l,s]of e){let a=i.indexOf(l),u=VJS._ᐟ$q(0,`[name="${l}"]`,0)||VJS._ᐟ$i(l);if(o.push(l),s){if(a>-1&&i.splice(a,1),VJS._ᐦi().$hda(u,"encode"))try{e.set(l,btoa(s))}catch(c){VJS._err(c.message)}}else -1===a&&VJS._ᐦi().$ha(l,"required")&&i.push(l)}if(i.length)return{err:"mrf",data:i,ids:o};if("object"==typeof n)for(let S in n)e.append(S,n[S].trim());let f;return{err:"",data:f="s"===t?new URLSearchParams(e).toString():"j"===t?Object.entries(Object.fromEntries(e)).reduce((e,[t,r])=>({...e,[t.replace(/\-([\w])/g,e=>e[1].toUpperCase())]:VJS._ᐦvn(r)}),{}):e}}static _ᐦbd(e,t){if("string"==typeof e){if("#"===e[0]){let r=VJS._ᐦfd(e,"j");"nfe"===r.err&&VJS._ᐦde(VJS._E7),"mrf"===r.err&&VJS._err(VJS._E3),e=r.data}else e=Object.fromEntries(new URLSearchParams(e))}else if(e instanceof FormData||e.constructor!==({}).constructor){e[Symbol.iterator]||VJS._err(VJS._E8,0,TypeError);let n={};for(let[i,o]of e)n[i]=o;e=n}return{...Object.fromEntries(t.searchParams),...e}}static async _ᐦr(e,t="GET",r={}){t=t.toUpperCase();let n="POST"===t||"GET"===t,i,o,l,s={method:t,cache:"no-cache",headers:{"X-Requested-With":"XMLHttpRequest"}},a=!1,u=null;try{l=new URL(e,"/"===e[0]?location.origin:void 0),e=`${l.origin}${l.pathname}`,r=VJS._ᐦbd(r,l)}catch(c){return VJS._err(VJS._E9,0,TypeError,c),{success:a,data:u,message:c.toString()}}let S=n?new URLSearchParams(r).toString():JSON.stringify(r);if(["PUT","PATCH","POST","DELETE"].includes(t))try{Object.keys(r).length?(s.mode="cors",s.credentials="same-origin",s.headers["Content-Type"]=n?"application/x-www-form-urlencoded":"application/json",s.body=S):"DELETE"!==t&&VJS._err(VJS._E4,1,TypeError)}catch(f){return VJS._err(f.message,0,TypeError,f),{success:a,data:u,message:f.toString()}}else S&&(e+=`?${S}`);try{i=await fetch(e,s)}catch(V){o=V.toString()}if(!i)return{success:a,data:u,message:o};let J,d=i.headers.get("Content-Type");if(a=i.ok){let p="";204===i.status?p="204 No Content":d&&d.includes("/json")?((u=await i.json()).constructor===({}).constructor||Array.isArray(u))&&Object.keys(u).map(e=>u[e]=VJS._ᐦvn(u[e])):"Blob"!==(u=await i.blob()).constructor.name&&(u=await i.text()),J={success:a,data:u,message:p}}else J={success:a,data:u,message:`Response: ${i.status} ${VJS._RSC[i.status]??""}`};return J}static getInstance(e={}){return VJS._ᐦi(e)}static register(e={}){try{let t=VJS.getInstance(e);Object.getOwnPropertyNames(VJS.prototype).filter(e=>"constructor"!==e&&!~e.indexOf("_")).forEach(e=>window[e]=t[e])}catch(r){VJS._err(r.message)}}}